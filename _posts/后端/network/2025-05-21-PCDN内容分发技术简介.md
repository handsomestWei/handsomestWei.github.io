---
title: PCDN内容分发技术简介
date: 2025-05-21 14:40:00
categories: [后端, network]
tags: [后端, network, cdn, p2p]
image:
  path: /assets/img/posts/common/network.jpg
---

# PCDN内容分发技术简介

## CDN
Content Delivery Network，内容分发网络。
是一种边缘计算思想。传统方式将静态资源（图片、点播视频等）内容放在单一主服务器，被高频访问时负担很大，带宽有瓶颈。后来将内容复制成很多份，放在离用户更近的区域服务器上，就实现了内容的分发，主服务器的压力减小。

## P2P
peer-to-peer，对等式网络，又称点对点技术，是无中心服务器、依靠用户群（peers）交换信息的互联网体系。      
+ `作用` 减低以往网路传输中的节点，以降低资料遗失的风险。
+ `网络特点` 与有中心服务器的中央网络系统不同，对等网络的每个用户端既是一个节点，也有服务器的功能，任何一个节点无法直接找到其他节点，必须依靠其户群进行信息交流。

## PCDN
P2P+CDN（Peer to Peer Content Delivery Network）点对点内容分发网络。   
直接把内容放在了用户侧，例如手机终端、路由器等，变成了规模更大的内容源。   

### PCDN分发过程
一般依赖PCDN sdk（如浏览器插件、路由器内置等），使用节点发现机制例如向调度服务器获取分发节点信息，再使用P2P通信。
在网络中，内容持有的用户，需要消耗上行流量，将内容上传给对端用户；需求端需要消耗下行流量，从其他用户处下载内容。   

### PCDN对各用户角色影响
+ 内容运营商：降低CDN服务器访问压力，降低网络流量和带宽成本。
+ 运营商：分发时会产生海量的PCDN流量，对骨干传输网络形成了巨大压力。需要区分用户正常使用的上行流量包和针对PCDN包做限制，避免影响用户日常使用。
+ 用户侧：PCDN需要占用cpu资源做计算分流，内容有节点调度、分发流量计算控制、涉及视频的有流解压缩等；使用P2P分发内容时会占用上行上传带宽。但也会提供更好的内容访问体验，减少延时和卡顿等。例如播放B站视频时，B站会通过调度把你导向离你最近的CDN节点（比如邻居刚好也在看同一个视频，对应P2P节点可能就是邻居电脑）。大部分用户不知道PCDN在后台偷跑。

### 基于PCDN内容分发的P2P网络拓扑结构设计思考
+ 网状模型：每个节点按概率下载切片，通过增加节点，基于概率的方式可以达到很高的分享率。但延迟较高，完整拿到数据需要一段时间，拼凑完整包时需要频繁的节点信息交换做查询，对网络造成额外的负载。
+ 树状模型：由顶层节点获取数据源，一带二、二带四地层层分享给子节点，然后P2P层数越高，分享率也就越高。但有极大的弊端，一半以上的叶子节点不贡献数据；随着层次的增加，层次比较深的节点延迟比较高；树状结构比较危险，一旦某个子树根节点挂掉了，整个子树都需要重新建立，代价很大。
+ 平均分流模型：数据切片平均分到每个节点一份，本节点负责的那一份再分享给其他节点，节点之间互相分享，均摊效果好。

## 参考
+ [PCDN应用案例：腾讯云直播PCDN加速方案](https://cloud.tencent.com/developer/article/1454729?from=15425&policyId=20240001&traceId=01jvrdc4cxbd4smz6v4dxgy07v&frompage=seopage)
+ [NAT打洞图例](https://blog.csdn.net/li1055107552/article/details/131693446)